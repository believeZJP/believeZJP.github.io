<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>PHP学习经验积累</title>
		<link rel="stylesheet" type="text/css" href="../../css/itemList.css"/>
	</head>
	<body>
		<div>
			<h1>php安装教程</h1>
			<pre><code>
		安装XAMPP
			1.下载:
				个人电脑是64位的，从官网上没有windows版64位的，最后从百度软件里找到了，
				32位的可以直接从官网下载，下载地址：
				官网：https://www.apachefriends.org/zh_cn/index.html
				百度软件：http://rj.baidu.com/soft/detail/12489.html?ald
				
			安装之前可能需要安装C++的运行环境，
			用到的工具：
			DirectX_Repair-v3.2
		
		遇到的坑：
			多次安装失败，各种原因。
		爬坑经验：
			如果没有安装成功，建议将安装文件全部删除，重新安装，如果某些进程正在执行，直接用文件粉碎机粉碎即可。
			
		由于刚开始没有XAMPP 64的安装包，于是安装了WAMP。
		遇到的坑：
			也是没有C++等运行环境，缺少msvcr110.dll 等，
		爬坑经验：
			DirectX_Repair-v3.2
			
		运行：
			启动，正常点击start即可，端口被占用什么的，把相关的关掉，重启一下即可。
		
		运行项目(存放目录)：
			XAMPP:D:\software\xampp\htdocs
			WAMP:wamp/www
				</code></pre>
		</div>
		
		<hr />
		
		<div>
			<h1>php获取post参数</h1>
			<pre><code>
	PHP获取POST数据的几种方法：
	　　方法1、最常见的方法是：$_POST['fieldname'];
	　　说明：只能接收Content-Type: application/x-www-form-urlencoded提交的数据。
	
	　　方法2、file_get_contents("php://input");
	　　说明：
	　　允许读取 POST 的原始数据。
	　　和 $HTTP_RAW_POST_DATA 比起来，它给内存带来的压力较小，并且不需要任何特殊的 php.ini 设置。
	　　php://input 不能用于 enctype="multipart/form-data"。
	
	　　方法3、$GLOBALS['HTTP_RAW_POST_DATA'];
	　　说明：
	　　总是产生 $HTTP_RAW_POST_DATA 变量包含有原始的 POST 数据。
	　　此变量仅在碰到未识别 MIME 类型的数据时产生。
				</code></pre>
		</div>
		<hr />
		
		<div>
			<h1>PHP判断http请求是get还是post</h1>
			<pre><code>
		$_SERVER['REQUEST_METHOD']
		可用$_SERVER['REQUEST_METHOD']=="POST"判断 
			</code></pre>
		</div> 
		<hr />
		
		<div>
			<h1>php常用代码</h1>
			<pre><code>
		1.新建一个Object
			$data =  new stdClass();
			$data->physicalDeviceId = "3C4EBEB6EEA6D82E";
		2.新建一个数组并赋值
			$post_data = array();
			$post_data = array("key" => "fadf","tel" => "15245663241");
		3.调试常用
			echo :用于输出一个字符串
			var_dump : 用于输出一个对象，可以是数组
		4.定义一个变量
			$a = "";//前面一定要用$!!!!
		5.字符串拼接
			只能用 . 来拼接！！！！！
			严重区别于js和java.
			eg:
			echo "abc"."defg";
			$a .= "higkl";//区别与js中的+=;
		6.http请求到php，获取请求中的cookie,获取浏览器的信息：
			$_COOKIE
			$_SERVER['HTTP_USER_AGENT']
		7.查看http请求方式：
			$_SERVER['REQUEST_METHOD']
			返回GET 或 POST
		8.循环数组的几种方式，
			$i =0;
			foreach ($data as $key=>$val) {
				if($i == 0){}else{
					$url_get  .="&".$key."=".$val;
				}
				$i ++;
			}
			
			//用for 
			$shuzu=array("ni","wo","ta","php","mysql"); 
			$count=count($shuzu); 
			echo "使用for遍历数组"; 
			for($i=0;$i<$count;$i++){ 
				$j=$i+1; 
				echo "第{$j}个元素是: $shuzu[$i]"; 
			} 
		9.获取数组的长度
			count($shuzu); 
			
			
		10.时间获取
			1. 获取时间戳
				date('U')
			2. 获取年月日  (需要考虑时间区间的问题,先设置一下时区,可以根据实际情况取舍)
				ini_set('date.timezone','Asia/Shanghai');
				date("Y-m-d H:i:s"); 
				date('Y-m-d H:i:s',time())
				
				
				
				
		11. 去除csv头部的bom,
			//原因:由于导出csv的时候,自动在csv文件前面添加了bom信息,导致再次导入的时候识别到了别的信息,无法正常的解析csv字段信息.
			解决办法:
			
			public function check_file_bom($filename,$remove = true) {
		        global $auto;
		        $contents = file_get_contents($filename);
		        $charset[1] = substr($contents, 0, 1);
		        $charset[2] = substr($contents, 1, 1);
		        $charset[3] = substr($contents, 2, 1);
		        if (ord($charset[1]) == 239 && ord($charset[2]) == 187 && ord($charset[3]) == 191) {
		            if($remove) {
		                $rest = substr($contents, 3);
		                $filenum = fopen($filename, "w");
		                flock($filenum, LOCK_EX);
		                fwrite($filenum, $rest);
		                fclose($filenum);
		            }
		            return true;
		        }
		        return false;
		    }
		    
		    
				
			</code></pre>
		</div> 
		<hr />
		
		
		<div>
			<h1>用cURL实现Get和Post-----><a href="phpProjects/ProxyProject/testForProxy.html" target="_blank">示例页面</a></h1>
			<pre><code>
		   //初始化   GET方式
	　　$ch = curl_init();
	　　//设置选项，包括URL
	　　curl_setopt($ch, CURLOPT_URL, "http://www.jb51.net");
	　　curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
	　　curl_setopt($ch, CURLOPT_HEADER, 0);
	　　//执行并获取HTML文档内容
	　　$output = curl_exec($ch);
	　　//释放curl句柄
	　　curl_close($ch);
	　　//打印获得的数据
	　　print_r($output);
	
		//POST请求
		$url = "http://api.91cha.com/phone";
		echo("请求连接为：".$url);
		$post_data = array("key" => "950603b21647469e913e5c1bcc1d5b82","tel" => "15245663241");
		$curl = curl_init();
		curl_setopt($curl, CURLOPT_URL, $url);
		curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
		curl_setopt($curl, CURLOPT_POST, 1);// post数据
		curl_setopt($curl, CURLOPT_POSTFIELDS, $post_data);// post的变量
		$output = curl_exec($curl);//打印获得的数据
		var_dump($post_data);
		
		curl_close($curl);
		print_r($output);
			</code></pre>
		</div>
		
		<div>
			<h1>php配置debug，打印格式化的日志</h1>
			<pre><code>
	   zend_extension="php_xdebug.dll"
　　xdebug.remote_enable = On
　　xdebug.remote_host = "localhost"
　　xdebug.remote_port = 9000
　　xdebug.remote_handler = "dbgp"
　　xdebug.auto_trace = 1
　　xdebug.collect_includes = 1
　　xdebug.collect_params = 1
　　xdebug.collect_return = 1
　　xdebug.default_enable = 1
　　xdebug.collect_assignments = 1
　　xdebug.collect_vars = 1
　　xdebug.remote_autostart = 1
　　xdebug.remote_connect_back = 1
　　xdebug.show_local_vars = 1
　　xdebug.show_exception_trace = 0
//后面三个用于var_dump()函数输出不完整，有省略号的解决办法-----放到php.ini中
	xdebug.var_display_max_children=128
	xdebug.var_display_max_data=512
	xdebug.var_display_max_depth=5
	
	
	
	
	array_push($openIdList,array("openId" => $openIds[$k]['openId'],"$provider" => $openIds[$k]['provider']));
	
	php根据某个字段排序
	function sortArrByField($array, $field, $desc = false){
	  $fieldArr = array();
	  foreach ($array as $k => $v) {
	    $fieldArr[$k] = $v[$field];
	  }
	  $sort = $desc == false ? SORT_ASC : SORT_DESC;
	  array_multisort($fieldArr, $sort, $array);
	}
	
	
	php数组合并
	
	$fruits = array("apple","banana","pear");  
$numbered = array("1","2","3");  
$cards = array_merge($fruits, $numbered);  
	
	
	php替换指定字符串
	$s =  str_replace("red",'green',"tertwered");//把red 替换成green
	echo $s;
	//输出结果tertwegreen
	
	
	$temp =floatval(12345678.90123456789);
echo $temp;
php的floatval最多只支持14位的数字，再多就自动截取了，

这个可以配置，在php.ini中，有
precision=14  可以配置。




isset(var) 和empty(var)
PHP的isset()函数 一般用来检测变量是否设置 
格式：bool isset ( mixed var [, mixed var [, ...]] ) 

功能：检测变量是否设置 

返回值： 

若变量不存在则返回 FALSE 
若变量存在且其值为NULL，也返回 FALSE 
若变量存在且值不为NULL，则返回 TURE 
同时检查多个变量时，每个单项都符合上一条要求时才返回 TRUE，否则结果为 FALSE 



PHP的empty()函数 判断值为否为空
功能：检查一个变量是否为空 

返回值： 

若变量不存在则返回 TRUE 
若变量存在且其值为""、0、"0"、NULL、、FALSE、array()、var $var; 以及没有任何属性的对象，则返回 TURE 
若变量存在且值不为""、0、"0"、NULL、、FALSE、array()、var $var; 以及没有任何属性的对象，则返回 FALSE 
			</code></pre>
		</div> 
		
		<div>
			<h1>
				php实现统计接口
			</h1>
			<pre><code>
				支持对多个统计量的查询和增减操作
				完整写出输入，计算，输出，输出，容错的代码
				
				
				Php接口文件（check.php）:

				<?php
				$jsonp_supporter = $_GET[‘callback’];
				$p_name=$_GET[‘p_name’];
				$result=array(‘err’=>0,’data’=>$p_name);
				echo $jsonp_supporter,”(“.json_encode($result).”)”;
				?>
				
				Js/jquery通过ajax技术调用接口:
				
				$.get(“http://***/check.php”,{p_name:’ddd’},function(data){
				console.log(data.data);
				},’jsonp’);
				
				这里使用了query中的get方法与接口进行数据交互。
				
				简单统计访问量类
				<?php
				/**
				* 统计访问量类
				*
				* 表:
				* CREATE TABLE `meng_stats` (
				* `type` char(16) NOT NULL,
				* `variable` char(20) NOT NULL,
				* `count` int(12) unsigned NOT NULL default '0',
				* PRIMARY KEY (`type`,`variable`)
				* ) ENGINE=MyISAM DEFAULT CHARSET=utf8;
				*
				* type:统计类型
				* variable统计标识量
				* count统计值
				*/
				class Stats {
				    /**
				     * 统计需要用session
				     *
				     */
				    function __construct() {
				        if (session_id() == '') {
				            session_start();
				        }
				    }
				    /**
				     * 验证该统计是否已经存在
				     *
				     * @param string $type
				     * @param string $variable
				     * @return bool
				     */
				    private function _verify($type, $variable) {
				        $sql = "select count from " . $GLOBALS['cms']->table('stats') ."
				     where `type` = '$type' and `variable` = '$variable';";
				        $qr = $GLOBALS['db']->query($sql);
				        if ($rs = $GLOBALS['db']->fetchArray($qr)) {
				            return true; // 该统计已经存在
				        } else {
				            return false; // 该统计尚未存在
				        }
				    }
				    /**
				     * 新建统计
				     *
				     * @param string $type 统计分类
				     * @param string $variable 统计标志变量
				     * @return bool
				     */
				    public function _create($type, $variable) {
				        $sql = "INSERT INTO " . $GLOBALS['cms']->table('stats') ."
				         VALUES ('$type', '$variable', 1);";
				        if ($qr = $GLOBALS['db']->query($sql)) {
				            return true; // 创建统计成功
				        } else {
				            return false; // 创建统计失败
				        }
				    }
				    /**
				     * 获取统计信息
				     *
				     * @param string $type
				     * @param string $variable
				     * @return string
				     */
				    public function get($type, $variable, $verify = true, $update = true){
				        /* 验证是否添加一个统计 */
				        if ($verify) {
				            /* 如果还没有该统计,则添加 */
				            if (!$this->_verify($type, $variable)) {
				                $this->_create($type, $variable);
				            }
				        }
				        /* 更新统计 */
				        if ($update) {
				            $this->_update($type, $variable);
				        }
				        /* 获取统计信息 */
				        $sql = "select count from " . $GLOBALS['cms']->table('stats') ."
				     where `type` = '$type' and `variable` = '$variable';";
				        $qr = $GLOBALS['db']->query($sql);
				        $rs = $GLOBALS['db']->fetchArray($qr);
				        return $rs['count'];
				    }
				    /**
				     * 更新统计信息
				     *
				     * @param string $type
				     * @param string $variable
				     * @return bool
				     */
				    private function _update($type, $variable) {
				        /* 防刷新 */
				        if (isset($_SESSION['stats_' . $type . $variable])) {
				            return true; // 函数运行完成,不更新数据库
				        } else {
				            $_SESSION['stats_' . $type . $variable] = true;
				        }
				        /* 更新统计 */
				        $sql = "UPDATE " . $GLOBALS['cms']->table('stats') ."
				         SET `count` = ' ". ($this->get($type, $variable)+1) . "'
				         WHERE CONVERT( `type` USING utf8 ) = '$type' AND CONVERT( `variable` USING utf8 ) = '$variable'
				         LIMIT 1 ";
				        if ($qr = $GLOBALS['db']->query($sql)) {
				            return true;
				        } else {
				            return false;
				        }
				    }
				}
				?> 
			</code></pre>
		</div>
		<hr />
		<div>
			<h1>get、put、post、delete含义与区别</h1>
			<pre><code>
1、GET请求会向数据库发索取数据的请求，从而来获取信息，该请求就像数据库的select操作一样，只是用来查询一下数据，不会修改、增加数据，不会影响资源的内容，即该请求不会产生副作用。无论进行多少次操作，结果都是一样的。

2、与GET不同的是，PUT请求是向服务器端发送数据的，从而改变信息，该请求就像数据库的update操作一样，用来修改数据的内容，但是不会增加数据的种类等，也就是说无论进行多少次PUT操作，其结果并没有不同。

3、POST请求同PUT请求类似，都是向服务器端发送数据的，但是该请求会改变数据的种类等资源，就像数据库的insert操作一样，会创建新的内容。几乎目前所有的提交操作都是用POST请求的。

4、DELETE请求顾名思义，就是用来删除某一个资源的，该请求就像数据库的delete操作。

就像前面所讲的一样，既然PUT和POST操作都是向服务器端发送数据的，那么两者有什么区别呢。。。POST主要作用在一个集合资源之上的（url），而PUT主要作用在一个具体资源之上的（url/xxx），通俗一下讲就是，如URL可以在客户端确定，那么可使用PUT，否则用POST。

综上所述，我们可理解为以下：

1、POST    /url      创建  
2、DELETE  /url/xxx  删除  
3、PUT     /url/xxx  更新

4、GET     /url/xxx  查看
			</code></pre>
		</div>
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		<script type="text/javascript">
			var h1s = document.getElementsByTagName("h1");
			for (var i = 0; i < h1s.length; i++) {
				(function(i){  
					var temp = h1s[i];
					console.log(temp);
					temp.onclick = function(i){
						var dis =  temp.nextElementSibling.style.display ;
						if(dis === "none"){
							temp.nextElementSibling.style.display = 'block';
						}else{
							temp.nextElementSibling.style.display = 'none';
						}
					};
				})(i);  
			}
		</script>
	</body>
</html>
