[链接](http://www.alixixi.com/web/a/2010062560089.shtml)

# 词法作用域
变量的作用域是在定义时决定而不是执行时决定, 词法作用域取决于源码, 通过静态分析就能确定, 因此词法作用域也叫做静态作用域. with 和 eval 除外, 所以说JS的作用域机制非常接近词法作用域(Lexical scope).

通过几个案例理解一下。

1. 经典案例一
```
function a(i){
    var i;
    alert(i);
}
a(10);

// 10
```
执行过程：

a有个形参i, 调用a时传入实参10, 形参i = 10,
接着定义一个同名的局部变量i, 未赋值
alert输出10

思考： 局部变量 i 和形参 i 是同一个存储空间吗?


2. 经典案例二
```
function a(i){
    alert(i);
    alert(arguments[0]);// arguments[0]应该就是形参i
    var i = 2;
    alert(i);
    alert(arguments[0]);
}
a(10);

// 10, 10, 2, 2
```
执行过程：

a有个形参i, 调用a时传入实参10, 形参i=10
第一个alert 输出形参i的值10, 
第二个alert输出arguments[0], 也是i
定义局部变量 i  并赋值为2, 这时局部变量 i = 2
第三个alert输出局部变量 i 的值 2
第四个alert 再次输出arguments[0] 2
思考： 能说明局部变量 i 和形参 i 的值相同吗


3. 经典案例三

```
function a(i){
    var i = i;
    alert(i);
}
a(10);

// 10
``` 
执行过程：

第一句声明一个与形参 i 同名的局部变量 i, 根据结果, 后一个 i 指向了形参 i,
等于把形参 i 的值10赋给了局部变量 i

第二句alert 输出10

思考：结合案例二, 说明局部变量 i 和形参 i 指向了同一个存储地址.

4. 经典案例四
```
var i = 10;
function a(){
    alert(i);
    var i = 2;
    alert(i);
}
a();

// undefined 2
```
解析过程：

1. 执行顺序

编译型语言, 编译步骤为: 词法分析, 语法分析, 语义分析, 语义检查, 代码优化和字节生成.

解释型语言: 通过词法分析和语法分析得到语法分析树后, 就可以开始执行了.

JavaScript执行过程: 如果一个文档流中包含多个script代码段(用script标签分隔的js代码或引入的js文件), 执行顺序是：
    1. 读入第一个代码段(js执行引擎并非一行一行的执行程序, 而是一段一段的分析执行)
    2. 做词法分析和语法分析, 有错则报语法错误, 跳转到步骤5
    3. 对 var 变量 和 function 定义做预解析
    4. 执行代码段, 有错则报错(如变量未定义)
    5. 如果还有下一个代码段, 则读入下一个代码段, 重复步骤2
    6. 结束

特殊说明：
    全局域下所有JS 代码可以被看作一个匿名方法, 会被自动执行, 而此匿名方法内的其他方法则是在被显式调用时才执行
